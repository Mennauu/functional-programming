<!DOCTYPE html>
<html lang=nl>
  <head>
    <meta charset="utf-8">
    <title>Chart</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,700,900" rel="stylesheet">
  </head>
  <body>
    <div class="wrapper">
      <h1>Verschil tussen Engelse boeken die vertaald worden naar<br> het Nederlands en niet vertaald worden (van 2000 tot 2018)</h1>
      <div class="left">
        <span>Aantal boeken</span>
      </div>
      <svg></svg>
      <div class="right">
        <span>Vertaald van Engels naar Nederlands <i style="color: #2FB0F0;">--•--</i></span><br><br>
        <span>Niet vertaald <i style="color: #FE8844;;">--•--</i></span>
      </div>
    </div>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script>

      /***********************
       * D3 DATAVISUALISATIE *
       ***********************/

      // Set the dimensions and margins of the graph
      const margin = {top: 50, right: 50, bottom: 50, left: 50},
      width = 1100- margin.left - margin.right,
      height = 550 - margin.top - margin.bottom

      // parse the time
      let parseTime = d3.timeParse("%Y");

      //  Set the ranges
      let x = d3.scaleTime().range([0, width])
      let y = d3.scaleLinear().range([height, 0])

      // define the amount of english books that are translated to dutch
      let line = d3.line()
        .x(function(d) { return x(d.year) })
        .y(function(d) { return y(d.amount) })
        //.curve(d3.curveMonotoneX) // apply smoothing

      // define the amount of books that aren't translated to dutch
      let line2 = d3.line()
        .x(function(d) { return x(d.year); })
        .y(function(d) { return y(d.amount2); })
        //.curve(d3.curveMonotoneX) // apply smoothing

      // Add SVG to page
      const svg = d3.select("svg").append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
        .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      function draw(data) {

        // format the data
        data.forEach(function(d) {
            d.year = parseTime(d.year)
            d.amount = +d.amount
            d.amount2 = +d.amount2
        });

        // sort years ascending
        data.sort(function(a, b){
          return a["Date"]-b["Date"]
      	})

        // Scale the range of the data
        x.domain(d3.extent(data, function(d) { return d.year; }))
        y.domain([0, d3.max(data, function(d) {return Math.max(d.amount, d.amount2); })])

        // Add the line path.
        svg.append("path")
            .data([data])
            .attr("class", "line")
            .attr("d", line)

        // Add the second line path.
        svg.append("path")
            .data([data])
            .attr("class", "line2")
            .attr("d", line2)

        // Add the X Axis
        svg.append("g")
            .attr("transform", "translate(0," + height + ")")
            .attr("class", "text")
            .call(d3.axisBottom(x))

        // Add the Y Axis
        svg.append("g")
            .attr("class", "text")
            .call(d3.axisLeft(y))

        // sets a circle for each year
        svg.selectAll(".dot")
            .data(data)
            .enter().append("circle")
            .attr("class", "dot")
            .attr("cx", function(d) { return x(d.year)})
            .attr("cy", function(d) { return y(d.amount)})
            .attr("r", 5)
      }

      // Get the data
      d3.json("results.json", function(error, data) {
        if (error) throw error;
        // trigger render
        draw(data)
      })
    </script>
  </body>
</html>
